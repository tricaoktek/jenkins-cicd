node {
  // scm {
  //   git('git://github.com/wardviaene/docker-demo.git') {  node -> // is hudson.plugins.git.GitSCM
  //     node / gitConfigName('tri.cao@ktek.io')
  //     node / gitConfigEmail('tri.cao@ktek.io')
  //   }
  // }

  // env.GIT_REPO_NAME = scm.getUserRemoteConfigs()[0].getUrl().tokenize('/')[3].split("\\.")[0]

  // job
  try {
    stage('build') {
      println('Building...')
    }
    stage('test') {
      println('Running Unit Test...')
      telegramSend("Unit Test for ${env.GIT_REPO_NAME} SUCCESS: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]' (${env.BUILD_URL})")
      sh 'exit 1'
    }
  } catch(e) {
    // mark build as failed
    currentBuild.result = "FAILURE";

    // send telegram notification
    telegramSend("${env.GIT_REPO_NAME} FAILED: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]' (${env.BUILD_URL})")

    // throw the error
    throw e;
  }
}
